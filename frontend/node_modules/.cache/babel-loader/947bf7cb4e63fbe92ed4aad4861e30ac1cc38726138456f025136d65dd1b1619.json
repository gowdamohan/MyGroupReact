{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Box,Paper,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,TextField,Button,Chip,Typography,Grid,Card,CardContent,IconButton,Dialog,DialogTitle,DialogContent,DialogActions,FormControl,InputLabel,Select,MenuItem}from'@mui/material';import{Search,Add,Edit,Map}from'@mui/icons-material';import{useApi}from'../hooks/useApi';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminStates=()=>{const{data,loading,refetch}=useApi(()=>api.get('/admin/states',{params:countryFilter!=='all'?{countryId:countryFilter}:{}}));const[states,setStates]=useState([]);const[countries,setCountries]=useState([]);const[search,setSearch]=useState('');const[countryFilter,setCountryFilter]=useState('all');const[openDialog,setOpenDialog]=useState(false);const[editingState,setEditingState]=useState(null);const fetchStates=async()=>{try{await refetch();if(data){setStates(data.states||[]);setCountries(data.countries||[]);}}catch(error){console.error('Error fetching states:',error);}};const fetchCountries=async()=>{try{const response=await request({url:'/admin/countries',method:'GET'});if(response.data){setCountries(response.data.countries||[]);}}catch(error){console.error('Error fetching countries:',error);}};useEffect(()=>{fetchCountries();},[]);useEffect(()=>{fetchStates();},[countryFilter]);const filteredStates=states.filter(state=>{var _state$Country;return state.state_name.toLowerCase().includes(search.toLowerCase())||((_state$Country=state.Country)===null||_state$Country===void 0?void 0:_state$Country.country_name.toLowerCase().includes(search.toLowerCase()));});const handleEdit=state=>{setEditingState(state);setOpenDialog(true);};const handleCloseDialog=()=>{setOpenDialog(false);setEditingState(null);};return/*#__PURE__*/_jsxs(Box,{sx:{p:3},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h4\",sx:{mb:3,display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(Map,{sx:{mr:2}}),\"States Management\"]}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,sx:{mb:3},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"primary\",children:\"Total States\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:states.length})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"success.main\",children:\"Active States\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:states.filter(s=>s.status==='active').length})]})})})]}),/*#__PURE__*/_jsx(Paper,{sx:{p:2,mb:3},children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,alignItems:\"center\",children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,placeholder:\"Search states...\",value:search,onChange:e=>setSearch(e.target.value),InputProps:{startAdornment:/*#__PURE__*/_jsx(Search,{sx:{color:'action.active',mr:1}})}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:3,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Country\"}),/*#__PURE__*/_jsxs(Select,{value:countryFilter,onChange:e=>setCountryFilter(e.target.value),label:\"Country\",children:[/*#__PURE__*/_jsx(MenuItem,{value:\"all\",children:\"All Countries\"}),countries.map(country=>/*#__PURE__*/_jsx(MenuItem,{value:country.id,children:country.country_name},country.id))]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:3,children:/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"contained\",startIcon:/*#__PURE__*/_jsx(Add,{}),onClick:()=>setOpenDialog(true),children:\"Add State\"})})]})}),/*#__PURE__*/_jsx(TableContainer,{component:Paper,children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"State Name\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Country\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Status\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Created Date\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:loading?/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:5,align:\"center\",children:\"Loading...\"})}):filteredStates.length===0?/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:5,align:\"center\",children:\"No states found\"})}):filteredStates.map(state=>{var _state$Country2;return/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",children:state.state_name})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:((_state$Country2=state.Country)===null||_state$Country2===void 0?void 0:_state$Country2.country_name)||'N/A'})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:state.status,color:state.status==='active'?'success':'default',size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:new Date(state.created_date).toLocaleDateString()})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(IconButton,{onClick:()=>handleEdit(state),children:/*#__PURE__*/_jsx(Edit,{})})})]},state.id);})})]})}),/*#__PURE__*/_jsxs(Dialog,{open:openDialog,onClose:handleCloseDialog,maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:editingState?'Edit State':'Add State'}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"State Name\",margin:\"normal\",defaultValue:(editingState===null||editingState===void 0?void 0:editingState.state_name)||''}),/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,margin:\"normal\",children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Country\"}),/*#__PURE__*/_jsx(Select,{defaultValue:(editingState===null||editingState===void 0?void 0:editingState.country_id)||'',label:\"Country\",children:countries.map(country=>/*#__PURE__*/_jsx(MenuItem,{value:country.id,children:country.country_name},country.id))})]})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleCloseDialog,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",children:editingState?'Update':'Add'})]})]})]});};export default AdminStates;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}