{"ast":null,"code":"import _objectSpread from\"D:/MyGroupReact/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Container,Paper,TextField,Button,Typography,Box,Grid,FormControl,InputLabel,Select,MenuItem,Alert,FormControlLabel,Checkbox,Link,Divider,Stepper,Step,StepLabel}from'@mui/material';import{useAuth}from'../contexts/AuthContext';import{Link as RouterLink,useNavigate,Navigate}from'react-router-dom';import api from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Register=()=>{const[activeStep,setActiveStep]=useState(0);const[formData,setFormData]=useState({// Basic Info\nfirst_name:'',last_name:'',email:'',password:'',confirmPassword:'',phone:'',// Address Info\ncountry_id:'',state_id:'',district_id:'',address:'',pincode:'',// Additional Info\ndate_of_birth:'',gender:'',profession:'',// Terms\nagree_terms:false,newsletter:false});const[countries,setCountries]=useState([]);const[states,setStates]=useState([]);const[districts,setDistricts]=useState([]);const[error,setError]=useState('');const[loading,setLoading]=useState(false);const{register,isAuthenticated}=useAuth();const navigate=useNavigate();const steps=['Basic Information','Address Details','Additional Info'];useEffect(()=>{fetchCountries();},[]);useEffect(()=>{if(formData.country_id){fetchStates(parseInt(formData.country_id));}},[formData.country_id]);useEffect(()=>{if(formData.state_id){fetchDistricts(parseInt(formData.state_id));}},[formData.state_id]);if(isAuthenticated){return/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\",replace:true});}const fetchCountries=async()=>{try{const response=await api.get('/geographic/countries');setCountries(response.data);}catch(error){console.error('Failed to fetch countries:',error);}};const fetchStates=async countryId=>{try{const response=await api.get(\"/geographic/states?country_id=\".concat(countryId));setStates(response.data);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{state_id:'',district_id:''}));setDistricts([]);}catch(error){console.error('Failed to fetch states:',error);}};const fetchDistricts=async stateId=>{try{const response=await api.get(\"/geographic/districts?state_id=\".concat(stateId));setDistricts(response.data);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{district_id:''}));}catch(error){console.error('Failed to fetch districts:',error);}};const handleChange=e=>{const target=e.target;const name=target.name;const type=target.type;const value=type==='checkbox'?target.checked:target.value;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));};const handleSelectChange=name=>e=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:e.target.value}));};const validateStep=step=>{switch(step){case 0:return formData.first_name!==''&&formData.last_name!==''&&formData.email!==''&&formData.password!==''&&formData.confirmPassword!==''&&formData.phone!==''&&formData.password===formData.confirmPassword;case 1:return formData.country_id!==''&&formData.state_id!==''&&formData.district_id!==''&&formData.address!==''&&formData.pincode!=='';case 2:return formData.date_of_birth!==''&&formData.gender!==''&&formData.agree_terms;default:return false;}};const handleNext=()=>{if(validateStep(activeStep)){setActiveStep(prev=>prev+1);setError('');}else{setError('Please fill all required fields in the current step.');}};const handleBack=()=>{setActiveStep(prev=>prev-1);setError('');};const handleSubmit=async e=>{e.preventDefault();if(formData.password!==formData.confirmPassword){setError('Passwords do not match');return;}if(!formData.agree_terms){setError('Please accept the terms and conditions');return;}setLoading(true);setError('');try{await register(formData);navigate('/dashboard');}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Registration failed');}finally{setLoading(false);}};const renderStepContent=step=>{switch(step){case 0:return/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,name:\"first_name\",label:\"First Name\",value:formData.first_name,onChange:handleChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,name:\"last_name\",label:\"Last Name\",value:formData.last_name,onChange:handleChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,name:\"email\",label:\"Email Address\",type:\"email\",value:formData.email,onChange:handleChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,name:\"phone\",label:\"Phone Number\",value:formData.phone,onChange:handleChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,name:\"password\",label:\"Password\",type:\"password\",value:formData.password,onChange:handleChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,name:\"confirmPassword\",label:\"Confirm Password\",type:\"password\",value:formData.confirmPassword,onChange:handleChange,error:formData.password!==formData.confirmPassword&&formData.confirmPassword!=='',helperText:formData.password!==formData.confirmPassword&&formData.confirmPassword!==''?'Passwords do not match':''})})]});case 1:return/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,required:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Country\"}),/*#__PURE__*/_jsx(Select,{value:formData.country_id,label:\"Country\",onChange:handleSelectChange('country_id'),children:countries.map(country=>/*#__PURE__*/_jsx(MenuItem,{value:country.id,children:country.name},country.id))})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,required:true,disabled:!formData.country_id,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"State\"}),/*#__PURE__*/_jsx(Select,{value:formData.state_id,label:\"State\",onChange:handleSelectChange('state_id'),children:states.map(state=>/*#__PURE__*/_jsx(MenuItem,{value:state.id,children:state.name},state.id))})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,required:true,disabled:!formData.state_id,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"District\"}),/*#__PURE__*/_jsx(Select,{value:formData.district_id,label:\"District\",onChange:handleSelectChange('district_id'),children:districts.map(district=>/*#__PURE__*/_jsx(MenuItem,{value:district.id,children:district.name},district.id))})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,name:\"pincode\",label:\"Pincode\",value:formData.pincode,onChange:handleChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,name:\"address\",label:\"Full Address\",multiline:true,rows:3,value:formData.address,onChange:handleChange})})]});case 2:return/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,name:\"date_of_birth\",label:\"Date of Birth\",type:\"date\",InputLabelProps:{shrink:true},value:formData.date_of_birth,onChange:handleChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,required:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Gender\"}),/*#__PURE__*/_jsxs(Select,{value:formData.gender,label:\"Gender\",onChange:handleSelectChange('gender'),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"male\",children:\"Male\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"female\",children:\"Female\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"other\",children:\"Other\"})]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,name:\"profession\",label:\"Profession (Optional)\",value:formData.profession,onChange:handleChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Checkbox,{name:\"agree_terms\",checked:formData.agree_terms,onChange:handleChange,required:true}),label:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[\"I agree to the\",' ',/*#__PURE__*/_jsx(Link,{href:\"#\",color:\"primary\",children:\"Terms and Conditions\"}),' ',\"and\",' ',/*#__PURE__*/_jsx(Link,{href:\"#\",color:\"primary\",children:\"Privacy Policy\"})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Checkbox,{name:\"newsletter\",checked:formData.newsletter,onChange:handleChange}),label:\"Subscribe to our newsletter for updates\"})})]});default:return null;}};return/*#__PURE__*/_jsx(Container,{component:\"main\",maxWidth:\"md\",children:/*#__PURE__*/_jsx(Box,{sx:{marginTop:4,marginBottom:4},children:/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{padding:4},children:[/*#__PURE__*/_jsxs(Box,{textAlign:\"center\",mb:4,children:[/*#__PURE__*/_jsx(Typography,{component:\"h1\",variant:\"h4\",color:\"primary\",fontWeight:\"bold\",children:\"Join My Group\"}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",color:\"textSecondary\",children:\"Create your account to connect with communities\"})]}),/*#__PURE__*/_jsx(Stepper,{activeStep:activeStep,sx:{mb:4},children:steps.map(label=>/*#__PURE__*/_jsx(Step,{children:/*#__PURE__*/_jsx(StepLabel,{children:label})},label))}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:2},children:error}),/*#__PURE__*/_jsxs(Box,{component:\"form\",onSubmit:handleSubmit,children:[renderStepContent(activeStep),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',mt:4},children:[/*#__PURE__*/_jsx(Button,{disabled:activeStep===0,onClick:handleBack,variant:\"outlined\",children:\"Back\"}),activeStep===steps.length-1?/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",disabled:loading||!validateStep(activeStep),size:\"large\",children:loading?'Creating Account...':'Create Account'}):/*#__PURE__*/_jsx(Button,{onClick:handleNext,variant:\"contained\",disabled:!validateStep(activeStep),size:\"large\",children:\"Next\"})]})]}),/*#__PURE__*/_jsx(Divider,{sx:{my:3}}),/*#__PURE__*/_jsx(Box,{textAlign:\"center\",children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"textSecondary\",children:[\"Already have an account?\",' ',/*#__PURE__*/_jsx(Link,{component:RouterLink,to:\"/login\",color:\"primary\",children:\"Sign in here\"})]})})]})})});};export default Register;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}