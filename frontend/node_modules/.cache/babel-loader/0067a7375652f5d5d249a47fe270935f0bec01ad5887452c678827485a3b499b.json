{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Box,Paper,Table,TableBody,TableCell,TableContainer,TableHead,TablePagination,TableRow,TextField,FormControl,InputLabel,Select,MenuItem,Button,Chip,Avatar,Typography,Grid,Card,CardContent}from'@mui/material';import{Search,FilterList,HelpOutline,Person,LocationOn}from'@mui/icons-material';import{useApi}from'../hooks/useApi';import api from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminNeedy=()=>{const{data,loading,refetch}=useApi(()=>api.get('/admin/needy',{params:{page:page+1,limit:rowsPerPage,search,category:categoryFilter,status:statusFilter}}));const[services,setServices]=useState([]);const[page,setPage]=useState(0);const[rowsPerPage,setRowsPerPage]=useState(10);const[totalCount,setTotalCount]=useState(0);const[search,setSearch]=useState('');const[categoryFilter,setCategoryFilter]=useState('all');const[statusFilter,setStatusFilter]=useState('all');const fetchServices=async()=>{try{await refetch();if(data){var _data$pagination;setServices(data.services||[]);setTotalCount(typeof data.total==='number'?data.total:((_data$pagination=data.pagination)===null||_data$pagination===void 0?void 0:_data$pagination.total)||0);}}catch(error){console.error('Error fetching needy services:',error);}};useEffect(()=>{fetchServices();},[page,rowsPerPage,search,categoryFilter,statusFilter]);const handleChangePage=(_,newPage)=>{setPage(newPage);};const handleChangeRowsPerPage=event=>{setRowsPerPage(parseInt(event.target.value,10));setPage(0);};const getStatusColor=status=>{switch(status){case'active':return'success';case'inactive':return'error';case'pending':return'warning';default:return'default';}};return/*#__PURE__*/_jsxs(Box,{sx:{p:3},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h4\",sx:{mb:3,display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(HelpOutline,{sx:{mr:2}}),\"Needy Services Management\"]}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,sx:{mb:3},children:/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"primary\",children:\"Total Services\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:totalCount})]})})})}),/*#__PURE__*/_jsx(Paper,{sx:{p:2,mb:3},children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,alignItems:\"center\",children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,placeholder:\"Search services...\",value:search,onChange:e=>setSearch(e.target.value),InputProps:{startAdornment:/*#__PURE__*/_jsx(Search,{sx:{color:'action.active',mr:1}})}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:3,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Category\"}),/*#__PURE__*/_jsxs(Select,{value:categoryFilter,onChange:e=>setCategoryFilter(e.target.value),label:\"Category\",children:[/*#__PURE__*/_jsx(MenuItem,{value:\"all\",children:\"All Categories\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"Medical\",children:\"Medical\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"Education\",children:\"Education\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"Financial\",children:\"Financial\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"Food\",children:\"Food\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"Other\",children:\"Other\"})]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:3,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Status\"}),/*#__PURE__*/_jsxs(Select,{value:statusFilter,onChange:e=>setStatusFilter(e.target.value),label:\"Status\",children:[/*#__PURE__*/_jsx(MenuItem,{value:\"all\",children:\"All Status\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"active\",children:\"Active\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"pending\",children:\"Pending\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"inactive\",children:\"Inactive\"})]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:2,children:/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(FilterList,{}),onClick:()=>{setSearch('');setCategoryFilter('all');setStatusFilter('all');},children:\"Clear\"})})]})}),/*#__PURE__*/_jsxs(TableContainer,{component:Paper,children:[/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Service\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Category\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Requester\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Location\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Status\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Created Date\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:loading?/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:6,align:\"center\",children:\"Loading...\"})}):services.length===0?/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:6,align:\"center\",children:\"No services found\"})}):services.map(service=>{var _service$service_desc,_service$country,_service$state,_service$district;return/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",sx:{mb:0.5},children:service.service_title}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",children:((_service$service_desc=service.service_description)===null||_service$service_desc===void 0?void 0:_service$service_desc.length)>100?\"\".concat(service.service_description.substring(0,100),\"...\"):service.service_description})]})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:service.service_category,size:\"small\",variant:\"outlined\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(Avatar,{sx:{mr:2,bgcolor:'secondary.main'},children:/*#__PURE__*/_jsx(Person,{})}),service.user&&/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[service.user.first_name,\" \",service.user.last_name]}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",children:service.user.email})]})]})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(LocationOn,{fontSize:\"small\",sx:{mr:0.5,color:'text.secondary'}}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",children:(_service$country=service.country)===null||_service$country===void 0?void 0:_service$country.country_name}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",color:\"text.secondary\",children:[(_service$state=service.state)===null||_service$state===void 0?void 0:_service$state.state_name,\", \",(_service$district=service.district)===null||_service$district===void 0?void 0:_service$district.district_name]})]})]})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:service.status,color:getStatusColor(service.status),size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:new Date(service.created_date).toLocaleDateString()})})]},service.id);})})]}),/*#__PURE__*/_jsx(TablePagination,{rowsPerPageOptions:[5,10,25],component:\"div\",count:totalCount,rowsPerPage:rowsPerPage,page:page,onPageChange:handleChangePage,onRowsPerPageChange:handleChangeRowsPerPage})]})]});};export default AdminNeedy;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}