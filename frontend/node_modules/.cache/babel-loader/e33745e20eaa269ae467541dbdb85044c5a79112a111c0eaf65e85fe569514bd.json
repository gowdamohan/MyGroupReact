{"ast":null,"code":"import _objectSpread from \"D:/MyGroupReact/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _classPrivateMethodInitSpec from \"D:/MyGroupReact/frontend/node_modules/@babel/runtime/helpers/esm/classPrivateMethodInitSpec.js\";\nimport _classPrivateFieldInitSpec from \"D:/MyGroupReact/frontend/node_modules/@babel/runtime/helpers/esm/classPrivateFieldInitSpec.js\";\nimport _classPrivateFieldGet from \"D:/MyGroupReact/frontend/node_modules/@babel/runtime/helpers/esm/classPrivateFieldGet2.js\";\nimport _assertClassBrand from \"D:/MyGroupReact/frontend/node_modules/@babel/runtime/helpers/esm/assertClassBrand.js\";\nimport _classPrivateFieldSet from \"D:/MyGroupReact/frontend/node_modules/@babel/runtime/helpers/esm/classPrivateFieldSet2.js\";\nvar _client, _currentResult, _currentMutation, _mutateOptions, _Class_brand;\n// src/mutationObserver.ts\nimport { getDefaultState } from \"./mutation.js\";\nimport { notifyManager } from \"./notifyManager.js\";\nimport { Subscribable } from \"./subscribable.js\";\nimport { hashKey, shallowEqualObjects } from \"./utils.js\";\nvar MutationObserver = (_client = /*#__PURE__*/new WeakMap(), _currentResult = /*#__PURE__*/new WeakMap(), _currentMutation = /*#__PURE__*/new WeakMap(), _mutateOptions = /*#__PURE__*/new WeakMap(), _Class_brand = /*#__PURE__*/new WeakSet(), class MutationObserver extends Subscribable {\n  constructor(client, options) {\n    super();\n    _classPrivateMethodInitSpec(this, _Class_brand);\n    _classPrivateFieldInitSpec(this, _client, void 0);\n    _classPrivateFieldInitSpec(this, _currentResult, void 0);\n    _classPrivateFieldInitSpec(this, _currentMutation, void 0);\n    _classPrivateFieldInitSpec(this, _mutateOptions, void 0);\n    _classPrivateFieldSet(_client, this, client);\n    this.setOptions(options);\n    this.bindMethods();\n    _assertClassBrand(_Class_brand, this, _updateResult).call(this);\n  }\n  bindMethods() {\n    this.mutate = this.mutate.bind(this);\n    this.reset = this.reset.bind(this);\n  }\n  setOptions(options) {\n    var _classPrivateFieldGet2;\n    const prevOptions = this.options;\n    this.options = _classPrivateFieldGet(_client, this).defaultMutationOptions(options);\n    if (!shallowEqualObjects(this.options, prevOptions)) {\n      _classPrivateFieldGet(_client, this).getMutationCache().notify({\n        type: \"observerOptionsUpdated\",\n        mutation: _classPrivateFieldGet(_currentMutation, this),\n        observer: this\n      });\n    }\n    if (prevOptions !== null && prevOptions !== void 0 && prevOptions.mutationKey && this.options.mutationKey && hashKey(prevOptions.mutationKey) !== hashKey(this.options.mutationKey)) {\n      this.reset();\n    } else if (((_classPrivateFieldGet2 = _classPrivateFieldGet(_currentMutation, this)) === null || _classPrivateFieldGet2 === void 0 ? void 0 : _classPrivateFieldGet2.state.status) === \"pending\") {\n      _classPrivateFieldGet(_currentMutation, this).setOptions(this.options);\n    }\n  }\n  onUnsubscribe() {\n    if (!this.hasListeners()) {\n      var _classPrivateFieldGet3;\n      (_classPrivateFieldGet3 = _classPrivateFieldGet(_currentMutation, this)) === null || _classPrivateFieldGet3 === void 0 || _classPrivateFieldGet3.removeObserver(this);\n    }\n  }\n  onMutationUpdate(action) {\n    _assertClassBrand(_Class_brand, this, _updateResult).call(this);\n    _assertClassBrand(_Class_brand, this, _notify).call(this, action);\n  }\n  getCurrentResult() {\n    return _classPrivateFieldGet(_currentResult, this);\n  }\n  reset() {\n    var _classPrivateFieldGet4;\n    (_classPrivateFieldGet4 = _classPrivateFieldGet(_currentMutation, this)) === null || _classPrivateFieldGet4 === void 0 || _classPrivateFieldGet4.removeObserver(this);\n    _classPrivateFieldSet(_currentMutation, this, void 0);\n    _assertClassBrand(_Class_brand, this, _updateResult).call(this);\n    _assertClassBrand(_Class_brand, this, _notify).call(this);\n  }\n  mutate(variables, options) {\n    var _classPrivateFieldGet5;\n    _classPrivateFieldSet(_mutateOptions, this, options);\n    (_classPrivateFieldGet5 = _classPrivateFieldGet(_currentMutation, this)) === null || _classPrivateFieldGet5 === void 0 || _classPrivateFieldGet5.removeObserver(this);\n    _classPrivateFieldSet(_currentMutation, this, _classPrivateFieldGet(_client, this).getMutationCache().build(_classPrivateFieldGet(_client, this), this.options));\n    _classPrivateFieldGet(_currentMutation, this).addObserver(this);\n    return _classPrivateFieldGet(_currentMutation, this).execute(variables);\n  }\n});\nfunction _updateResult() {\n  var _classPrivateFieldGet6, _classPrivateFieldGet7;\n  const state = (_classPrivateFieldGet6 = (_classPrivateFieldGet7 = _classPrivateFieldGet(_currentMutation, this)) === null || _classPrivateFieldGet7 === void 0 ? void 0 : _classPrivateFieldGet7.state) !== null && _classPrivateFieldGet6 !== void 0 ? _classPrivateFieldGet6 : getDefaultState();\n  _classPrivateFieldSet(_currentResult, this, _objectSpread(_objectSpread({}, state), {}, {\n    isPending: state.status === \"pending\",\n    isSuccess: state.status === \"success\",\n    isError: state.status === \"error\",\n    isIdle: state.status === \"idle\",\n    mutate: this.mutate,\n    reset: this.reset\n  }));\n}\nfunction _notify(action) {\n  notifyManager.batch(() => {\n    if (_classPrivateFieldGet(_mutateOptions, this) && this.hasListeners()) {\n      const variables = _classPrivateFieldGet(_currentResult, this).variables;\n      const context = _classPrivateFieldGet(_currentResult, this).context;\n      if ((action === null || action === void 0 ? void 0 : action.type) === \"success\") {\n        var _classPrivateFieldGet8, _classPrivateFieldGet9, _classPrivateFieldGet0, _classPrivateFieldGet1;\n        (_classPrivateFieldGet8 = (_classPrivateFieldGet9 = _classPrivateFieldGet(_mutateOptions, this)).onSuccess) === null || _classPrivateFieldGet8 === void 0 || _classPrivateFieldGet8.call(_classPrivateFieldGet9, action.data, variables, context);\n        (_classPrivateFieldGet0 = (_classPrivateFieldGet1 = _classPrivateFieldGet(_mutateOptions, this)).onSettled) === null || _classPrivateFieldGet0 === void 0 || _classPrivateFieldGet0.call(_classPrivateFieldGet1, action.data, null, variables, context);\n      } else if ((action === null || action === void 0 ? void 0 : action.type) === \"error\") {\n        var _classPrivateFieldGet10, _classPrivateFieldGet11, _classPrivateFieldGet12, _classPrivateFieldGet13;\n        (_classPrivateFieldGet10 = (_classPrivateFieldGet11 = _classPrivateFieldGet(_mutateOptions, this)).onError) === null || _classPrivateFieldGet10 === void 0 || _classPrivateFieldGet10.call(_classPrivateFieldGet11, action.error, variables, context);\n        (_classPrivateFieldGet12 = (_classPrivateFieldGet13 = _classPrivateFieldGet(_mutateOptions, this)).onSettled) === null || _classPrivateFieldGet12 === void 0 || _classPrivateFieldGet12.call(_classPrivateFieldGet13, void 0, action.error, variables, context);\n      }\n    }\n    this.listeners.forEach(listener => {\n      listener(_classPrivateFieldGet(_currentResult, this));\n    });\n  });\n}\nexport { MutationObserver };\n//# sourceMappingURL=mutationObserver.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}